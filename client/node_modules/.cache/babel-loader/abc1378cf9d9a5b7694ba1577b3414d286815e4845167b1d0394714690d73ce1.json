{"ast":null,"code":"import { ref, computed, onMounted, watch } from \"vue\";\nimport { useStore } from \"vuex\";\nexport default {\n  name: \"SpinWheelStep\",\n  setup() {\n    const store = useStore();\n    const wheelCanvas = ref(null);\n    const isSpinning = ref(false);\n    const rotation = ref(0);\n    const choices = computed(() => store.state.choices);\n    const customization = computed(() => store.state.wheelCustomization);\n    const drawWheel = () => {\n      const canvas = wheelCanvas.value;\n      const ctx = canvas.getContext(\"2d\");\n      const centerX = canvas.width / 2;\n      const centerY = canvas.height / 2;\n      const radius = Math.min(centerX, centerY) - 10;\n      ctx.clearRect(0, 0, canvas.width, canvas.height);\n      ctx.save();\n      ctx.translate(centerX, centerY);\n      ctx.rotate(rotation.value);\n      const totalChoices = choices.value.length;\n      const anglePerChoice = 2 * Math.PI / totalChoices;\n      choices.value.forEach((choice, index) => {\n        const startAngle = (choices.value.length - 1 - index) * anglePerChoice;\n        const endAngle = (choices.value.length - index) * anglePerChoice;\n        ctx.beginPath();\n        ctx.moveTo(0, 0);\n        ctx.arc(0, 0, radius, startAngle, endAngle);\n        ctx.closePath();\n\n        // Color logic (as before)\n        let color;\n        if (customization.value.colors && customization.value.colors[index]) {\n          color = customization.value.colors[index];\n        } else {\n          const hue = index * 137.5 % 360;\n          color = `hsl(${hue}, 70%, 50%)`;\n        }\n        ctx.fillStyle = color;\n        ctx.fill();\n\n        // Draw text\n        ctx.save();\n        ctx.rotate(startAngle + anglePerChoice / 2);\n        ctx.textAlign = \"center\";\n        ctx.textBaseline = \"middle\";\n        ctx.fillStyle = \"white\";\n        ctx.font = \"14px Arial\";\n        ctx.translate(radius / 2, 0);\n        ctx.rotate(Math.PI);\n        ctx.fillText(choice, 0, 0);\n        ctx.restore();\n      });\n      ctx.restore();\n    };\n    const spinWheel = () => {\n      if (isSpinning.value) return;\n      isSpinning.value = true;\n      const totalRotation = 2 * Math.PI * (5 + Math.random()); // 5-6 full rotations\n      const duration = 5000; // 5 seconds\n      const start = performance.now();\n      const animate = time => {\n        const elapsed = time - start;\n        const progress = Math.min(elapsed / duration, 1);\n        const easeProgress = 1 - Math.pow(1 - progress, 4); // Ease out quartic\n\n        rotation.value = totalRotation * easeProgress;\n        drawWheel();\n        if (progress < 1) {\n          requestAnimationFrame(animate);\n        } else {\n          // Calculate the result based on the final position of the wheel\n          const normalizedRotation = rotation.value % (2 * Math.PI);\n          const anglePerChoice = 2 * Math.PI / choices.value.length;\n          const choiceIndex = Math.floor((normalizedRotation + anglePerChoice / 2) / anglePerChoice) % choices.value.length;\n          const result = choices.value[choiceIndex];\n          console.log(\"Final rotation:\", rotation.value);\n          console.log(\"Normalized rotation:\", normalizedRotation);\n          console.log(\"Choice index:\", choiceIndex);\n          console.log(\"Selected result:\", result);\n          store.commit(\"setResult\", result);\n          store.commit(\"setCurrentStep\", 6);\n          isSpinning.value = false;\n        }\n      };\n      requestAnimationFrame(animate);\n    };\n    onMounted(() => {\n      drawWheel();\n    });\n    watch([choices, customization], () => {\n      drawWheel();\n    });\n    return {\n      wheelCanvas,\n      isSpinning,\n      spinWheel\n    };\n  }\n};","map":{"version":3,"names":["ref","computed","onMounted","watch","useStore","name","setup","store","wheelCanvas","isSpinning","rotation","choices","state","customization","wheelCustomization","drawWheel","canvas","value","ctx","getContext","centerX","width","centerY","height","radius","Math","min","clearRect","save","translate","rotate","totalChoices","length","anglePerChoice","PI","forEach","choice","index","startAngle","endAngle","beginPath","moveTo","arc","closePath","color","colors","hue","fillStyle","fill","textAlign","textBaseline","font","fillText","restore","spinWheel","totalRotation","random","duration","start","performance","now","animate","time","elapsed","progress","easeProgress","pow","requestAnimationFrame","normalizedRotation","choiceIndex","floor","result","console","log","commit"],"sources":["/Users/hyemin/Documents/Projects/decision-maker/client/src/components/SpinWheelStep.vue"],"sourcesContent":["<template>\n  <div class=\"spin-wheel-step\">\n    <h2>Spin the Wheel</h2>\n    <div class=\"wheel-container\">\n      <canvas ref=\"wheelCanvas\" width=\"400\" height=\"400\"></canvas>\n      <div class=\"wheel-arrow\"></div>\n    </div>\n    <button @click=\"spinWheel\" :disabled=\"isSpinning\">\n      {{ isSpinning ? \"Spinning...\" : \"Spin\" }}\n    </button>\n  </div>\n</template>\n\n<script>\nimport { ref, computed, onMounted, watch } from \"vue\";\nimport { useStore } from \"vuex\";\n\nexport default {\n  name: \"SpinWheelStep\",\n  setup() {\n    const store = useStore();\n    const wheelCanvas = ref(null);\n    const isSpinning = ref(false);\n    const rotation = ref(0);\n    const choices = computed(() => store.state.choices);\n    const customization = computed(() => store.state.wheelCustomization);\n\n    const drawWheel = () => {\n      const canvas = wheelCanvas.value;\n      const ctx = canvas.getContext(\"2d\");\n      const centerX = canvas.width / 2;\n      const centerY = canvas.height / 2;\n      const radius = Math.min(centerX, centerY) - 10;\n\n      ctx.clearRect(0, 0, canvas.width, canvas.height);\n      ctx.save();\n      ctx.translate(centerX, centerY);\n      ctx.rotate(rotation.value);\n\n      const totalChoices = choices.value.length;\n      const anglePerChoice = (2 * Math.PI) / totalChoices;\n\n      choices.value.forEach((choice, index) => {\n        const startAngle = (choices.value.length - 1 - index) * anglePerChoice;\n        const endAngle = (choices.value.length - index) * anglePerChoice;\n\n        ctx.beginPath();\n        ctx.moveTo(0, 0);\n        ctx.arc(0, 0, radius, startAngle, endAngle);\n        ctx.closePath();\n\n        // Color logic (as before)\n        let color;\n        if (customization.value.colors && customization.value.colors[index]) {\n          color = customization.value.colors[index];\n        } else {\n          const hue = (index * 137.5) % 360;\n          color = `hsl(${hue}, 70%, 50%)`;\n        }\n        ctx.fillStyle = color;\n        ctx.fill();\n\n        // Draw text\n        ctx.save();\n        ctx.rotate(startAngle + anglePerChoice / 2);\n        ctx.textAlign = \"center\";\n        ctx.textBaseline = \"middle\";\n        ctx.fillStyle = \"white\";\n        ctx.font = \"14px Arial\";\n        ctx.translate(radius / 2, 0);\n        ctx.rotate(Math.PI);\n        ctx.fillText(choice, 0, 0);\n        ctx.restore();\n      });\n\n      ctx.restore();\n    };\n\n    const spinWheel = () => {\n      if (isSpinning.value) return;\n\n      isSpinning.value = true;\n      const totalRotation = 2 * Math.PI * (5 + Math.random()); // 5-6 full rotations\n      const duration = 5000; // 5 seconds\n      const start = performance.now();\n\n      const animate = (time) => {\n        const elapsed = time - start;\n        const progress = Math.min(elapsed / duration, 1);\n        const easeProgress = 1 - Math.pow(1 - progress, 4); // Ease out quartic\n\n        rotation.value = totalRotation * easeProgress;\n\n        drawWheel();\n\n        if (progress < 1) {\n          requestAnimationFrame(animate);\n        } else {\n          // Calculate the result based on the final position of the wheel\n          const normalizedRotation = (rotation.value % (2 * Math.PI));\n          const anglePerChoice = (2 * Math.PI) / choices.value.length;\n          const choiceIndex = Math.floor((normalizedRotation + anglePerChoice / 2) / anglePerChoice) % choices.value.length;\n          const result = choices.value[choiceIndex];\n\n          console.log(\"Final rotation:\", rotation.value);\n          console.log(\"Normalized rotation:\", normalizedRotation);\n          console.log(\"Choice index:\", choiceIndex);\n          console.log(\"Selected result:\", result);\n\n          store.commit(\"setResult\", result);\n          store.commit(\"setCurrentStep\", 6);\n          isSpinning.value = false;\n        }\n      };\n\n      requestAnimationFrame(animate);\n    };\n\n\n    onMounted(() => {\n      drawWheel();\n    });\n\n    watch([choices, customization], () => {\n      drawWheel();\n    });\n\n    return {\n      wheelCanvas,\n      isSpinning,\n      spinWheel,\n    };\n  },\n};\n</script>\n\n<style scoped>\n.wheel-container {\n  position: relative;\n  width: 400px;\n  height: 400px;\n  margin: 0 auto;\n}\n\n.wheel-arrow {\n  position: absolute;\n  top: 0;\n  left: 50%;\n  width: 0;\n  height: 0;\n  border-left: 20px solid transparent;\n  border-right: 20px solid transparent;\n  border-top: 40px solid #333;\n  transform: translateX(-50%);\n}\n\nbutton {\n  margin-top: 20px;\n  padding: 10px 20px;\n  font-size: 18px;\n  cursor: pointer;\n}\n\nbutton:disabled {\n  cursor: not-allowed;\n  opacity: 0.6;\n}\n</style>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}